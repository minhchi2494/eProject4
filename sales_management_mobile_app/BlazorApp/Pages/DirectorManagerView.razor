@page "/directorManager/{id}"
@attribute [Authorize]
@using BlazorApp.Services
@using BlazorApp.Models
@inject IToastService ToastService
@inject IDirectorManagerServices _services;
@inject IDirectorServices _directorServices;

@if (loading)
{
    <table class="table">
        <tr>
            <td colspan="4" class="text-center">
                <span class="spinner-border spinner-border-lg align-center"></span>
            </td>
        </tr>
    </table>
}

@*<table class="table">
    <thead>
        <tr>
            <th>@manager.Fullname</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in managerUsers)
        {
            <tr>
                <td>Salesman: @item.Salesman</td>
                <td>
                    <a href="/userDetail/@item.SalesmanId" class="btn btn-outline-info"><i class="far fa-eye"></i></a>
                </td>
            </tr>
        }
    </tbody>
</table>*@

 <div class="row my-5">
        <div class="col-lg-6 col-xl-4 offset-lg-3 offset-xl-4">
            <RadzenCard class="m-3">
                <h3 class="h5">Manager Information</h3>
                <div class="d-flex flex-row">
                    <RadzenImage Path="/images/manager.jpg" Class="rounded-circle float-left mr-3" Style="width: 100px; height: 100px;" />
                    <div>
                        <div>Director</div>
                        <b>@director.Fullname</b>
                        <div class="mt-3">Company</div>
                        <b>FPT Company</b>
                    </div>
                </div>
            </RadzenCard>
            <RadzenCard class="m-3">
                <h3 class="h5">Director Information</h3>
                <div class="row">
                    <div class="col-md-4">
                        <div>Kpi Value</div>
                        <b>@director.KpiValue</b>
                        <div class="mt-3">Manager list:
                            <button @onclick="Show" class="form-control btn btn-primary">Show List</button>
                            @*<button @onclick="Hide" class="form-control btn btn-secondary">Show List</button>*@
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div>Actual Kpi</div>
                        <b>@director.ActualKpi</b>
                        <div class="mt-3">
                            <span style="color:#fff">Hide</span>
                            <button @onclick="Hide" class="form-control btn btn-secondary">Hide</button>
                        </div>
                       
                    </div>
                </div>
            </RadzenCard>
        </div>
    </div>

@if(showList)
{
<RadzenGrid style="margin-top: -30px;" @ref="directorManagerGrid" FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
            AllowFiltering="true" AllowPaging="true" PageSize="5" AllowSorting="true" Data="directorManagers" TItem="vDirectorManager" ColumnWidth="200px">
    <Columns>
        <RadzenGridColumn TItem="vDirectorManager" Property="ManagerId" Title="Manager Id">
            <FooterTemplate>
                Displayed: <b>@directorManagerGrid.View.Count()</b> of <b>@directorManagers.Count()</b>
            </FooterTemplate>
        </RadzenGridColumn>


        <RadzenGridColumn TItem="vDirectorManager" Property="ManagerName" Title="Manager Name"></RadzenGridColumn>


@*        <RadzenGridColumn TItem="vDirectorManager" Title="Action">
            <Template Context="data">
                <a href="/managerUser/@data.Id" class="btn btn-outline-info"><i class="far fa-eye"></i></a> &nbsp
                <a href="/editManager/@data.Id" class="btn btn-outline-warning"><i class="fas fa-pencil"></i></a>
            </Template>
        </RadzenGridColumn>*@

    </Columns>
</RadzenGrid>
}


<div><br /></div>
<a href="/account" class="btn btn-primary">Cancel</a>

@code {
    RadzenGrid<vDirectorManager> directorManagerGrid;

    private bool loading, showList;

    private List<vDirectorManager> directorManagers = new List<vDirectorManager>();

    private Director director = new Director();

    [Parameter]
    public string id { get; set; }

    protected override async Task OnInitializedAsync()
    {
        showList = false;
        loading = true;
        directorManagers = await _services.getDirectorManagers(id);
        director = await _directorServices.getDirector(id);
        loading = false;
    }


    
    private void Show()
    {
        showList = true;
    }

    private void Hide()
    {
        showList = false;
    }
}
